#!/usr/bin/env bash

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

cd $DIR

mkdir -p ${XDG_CONFIG_HOME:=$HOME/.config}
mkdir -p ${NVIM_HOME:=$XDG_CONFIG_HOME/nvim}
mkdir -p ${FISH_HOME:=$XDG_CONFIG_HOME/fish}
# mkdir -p ${SPACEMACS_HOME:=$HOME/.spacemacs.d}

ln -sf "$DIR/zshrc" "$HOME/.zshrc"
ln -sf "$DIR/vimrc" "$HOME/.vimrc"
ln -sf "$DIR/vimrc" "$NVIM_HOME/init.vim"
ln -sf "$DIR/config.fish" "$FISH_HOME/config.fish"
ln -sf "$DIR/fishfile" "$FISH_HOME/fishfile"
# ln -sf "$DIR/spacemacs" "$SPACEMACS_HOME/init.el"
ln -sf "$DIR/emacs" "$HOME/.emacs.d"
ln -sf "$DIR/starship.toml" "$XDG_CONFIG_HOME/starship.toml"

if [[ "$OSTYPE" == "darwin"* ]]; then
    mkdir -p ${KARABINER_HOME:=$XDG_CONFIG_HOME/karabiner}
    ln -sf "$DIR/karabiner.json" "$KARABINER_HOME/karabiner.json"
    mkdir -p ${CODE_HOME:=$HOME/Library/"Application Support"/Code/User}
    mkdir -p ${CODE_INSIDERS_HOME:=$HOME/Library/"Application Support"/"Code - Insiders"/User}
    ln -sf "$DIR/vscode/settings.json" "$CODE_HOME/settings.json"
    ln -sf "$DIR/vscode/keybindings.json" "$CODE_HOME/keybindings.json"
    ln -sf "$DIR/vscode/settings.json" "$CODE_INSIDERS_HOME/settings.json"
    ln -sf "$DIR/vscode/keybindings.json" "$CODE_INSIDERS_HOME/keybindings.json"
fi

if [[ ! "$OSTYPE" == "darwin"* ]]; then
    mkdir -p ${I3_HOME:=$XDG_CONFIG_HOME/i3}
    ln -sf "$DIR/Xresources" "$HOME/.Xresources"
    ln -sf "$DIR/i3" "$I3_HOME/config"
    ln -sf "$DIR/fonts" "$HOME/.fonts"
fi

if [ ! -d $HOME/bin ]; then
    echo "Creating bin dir"
    mkdir $HOME/bin
fi

if [ ! -e $FISH_HOME/functions/fisher.fish ]; then
    echo "Installing fisherman"
    curl -Lo $FISH_HOME/functions/fisher.fish --create-dirs git.io/fisher
fi

if [ ! -d $HOME/.asdf ]; then
   echo "Installing asdf";
   git clone https://github.com/asdf-vm/asdf.git ~/.asdf
fi

if [ ! -r ~/.config/base16-shell/scripts/base16-dracula.sh ]; then
    echo "Installing base16-shell into ~/.config/base16-shell";
    git clone https://github.com/chriskempson/base16-shell.git ~/.config/base16-shell
fi

